<!DOCTYPE html>
<html>
  <head>
    <title>Hello World</title>
    <link rel="shortcut icon" href="#" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <!--
    <script src="https://cdn.8thwall.com/web/aframe/8frame-1.2.0.min.js"></script>
    <script src="https://cdn.8thwall.com/web/xrextras/xrextras.js"></script>
    <script src="https://apps.8thwall.com/xrweb?appKey=f0LPUhzxQRN1kc4sv4mM4ZRsl663KCFL7y7fj3Uc5wN7TNKY7TbKuJlwz5uu0zGbngfYA3"></script>
    -->
    <script src="https://unpkg.com/@tensorflow/tfjs-core@3.13.0/dist/tf-core.js"></script>
    <script src="https://unpkg.com/@tensorflow/tfjs-converter@3.13.0/dist/tf-converter.js"></script>
    <script src="https://unpkg.com/@tensorflow/tfjs-backend-webgl@3.13.0/dist/tf-backend-webgl.js"></script>
    <script src="https://unpkg.com/@tensorflow-models/handpose@0.0.7/dist/handpose.js"></script>

    <script src="/socket.io/socket.io.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://supereggbert.github.io/aframe-htmlembed-component/dist/build.js"></script>
    <script src="https://unpkg.com/aframe-text-plane"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/letterizejs/lib/letterize.min.js"></script>

    <style>
      body {
        background-color: black;
      }
      video {
        position: fixed;
        bottom: 0;
        min-width: 100%;
        min-height: 100%;
      }
    </style>

    <script>
      const socket = io();

      let debug = true
      if (!debug) {
        socket.on('message', (data) => {
          let json = JSON.parse(data)
          // console.log(json)
          // showText(json)
        })
      } else {
        let text = "Hello my name is Ryo Suzuki. I am an Assistant Professor at the University of Calgary in Department of Computer Science. Today I want to talk about Real-time Augmented Presentation. As you can see when I talk and present something, we can augment presentation with live kinetic typography, embedded icons, embedded visuals, as well as embedded annotation to a physical object. All components are interactive with gestrual interactions. And most importantly it all happens in real-time. This means no video editing or programming. Thus it can signficiatnly reduces the time and efforts but also expands the tremendous potential of augmented presentation in real-time live talk. Augmented presentation has been widely used technique in YouTube or video documentary. They often use expressive embedded visuals to make the presentation more impressive and engagaging. However it requires a lot of time and efforts to produce such a video through video-editing tools. We wonder what if we can create this kind of videos in real-time. In this talk I want to introduce the system overview and how we implement this demo."
        text.replace('.', ' ')
        text.replace(',', ' ')
        socket.emit('message', text)
        socket.on('message', (data) => {
          let json = JSON.parse(data)
          window.json = json

          let i = 1
          setInterval(() => {
            let current = Object.assign({}, json)
            current.tokens = current.tokens.slice(0, i)
            showText(current)
            i++
          }, 1000)

        })

      }



    </script>


    <script src="js/animate-text.js"></script>
    <script src="js/show-text.js"></script>
    <script src="js/speech-recognition.js"></script>
    <script src="js/pose-detection.js"></script>

  </head>

  <body>
    <video id="video"></video>
    <a-scene 8thwall-camera-pipeline webcam-pipeline>
      <a-camera position="0 0 0" rotation="-45 0 0">
        <a-cursor gaze-event material="color: white;"></a-cursor>
      </a-camera>
      <a-entity id="hoge" animate-text text-plane="text: test" position="0 -1 -3" class="word"></a-entity>
      <a-entity id="fuga" text="value: fuga; width: 4" position="0 0 -3" class="word"></a-entity>
      <a-entity id="hand-0"></a-entity>
      <a-entity id="hand-1"></a-entity>
      <a-entity id="words"></a-entity>
      <a-plane id="background-plane" width="1000" height="1000" material="transparent: true; opacity: 0.1" position="0 0 -3"></a-plane>

    </a-scene>

  </body>
</html>
